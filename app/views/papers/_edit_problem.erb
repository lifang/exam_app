<script type="text/javascript">
  KE.show({
    id : 'edit_title_<%= edit_problem.attributes['id'] %>',
    wyswygMode : false,
    skinType: 'tinymce',
    cssPath : '/kindeditor/examples/index.css',
    items : [
      'source', 'undo', 'redo','copy', 'paste',
      'insertorderedlist', 'insertunorderedlist', 'indent', 'outdent',
      'specialchar', 'link', 'unlink', 'image', 'flash', 'media', '-',
      'fontname', 'fontsize', 'textcolor', 'bold',
      'italic', 'underline',  'table', 'hr'
    ]
  });
</script>
<div class="products_list_style_box"  style="display: none;" id="edit_problem_<%= edit_problem.attributes["id"].to_i %>" style="display:none;">
  <div class="arrow" style="top:10px;"></div>
  <div class="question_pic_box" style="top:0px;">
    <div class="in">
      <%= form_for :problem ,:url=>"/problems/#{edit_problem.attributes["id"].to_i}/update_problem" do |f| %>
        <%= f.hidden_field :problem_xpath,:value=>"#{edit_problem.xpath}" %>
        <%= f.hidden_field :problem_id,:value=>"#{edit_problem.attributes["id"]}" %>
        <%= f.hidden_field :question_id,:value=>"#{edit_problem.elements["questions"].elements["question"].attributes["id"]}" %>
        <%= f.hidden_field :paper_id,:value=>"#{@xml.attributes["id"]}" %>
        <div class="title">题面：</div>
        <%= f.text_area :title ,:cols=>"45", :rows=>"3", :class=>"textarea_style", :id => "edit_title_#{edit_problem.attributes["id"].to_i}",
          :value=>edit_problem.elements["title"].text %>
        <div class="title">选项：<div class="chose_add"><a href="#">增加选项</a></div></div>
        <div class="clear"></div>
        <div class="question">
          <% attrs_str=edit_problem.elements["questions"].elements["question"].elements["questionattrs"].text %>
          <% attrs_array=attrs_str.split(";-;") unless attrs_str.nil? %>
          <% attrs_length = (attrs_array and attrs_array.any?) ? attrs_array.length : 0 %>
          <%= f.hidden_field :attr_sum,:value=>"#{attrs_length}" %>
          <% (0..attrs_array.length-1).each do |i| %>
            <%
            is_answer_flag = false
            answer = edit_problem.elements["questions"].elements["question"].elements["answer"]
            if !answer.nil?  and !answer.text.nil? and answer.text == attrs_array[i]
              is_answer_flag = true
            end
          %>
            <div class="attr" <% if is_answer_flag %>style="border: 1px green solid;"<% end %>>
              <input type="radio" name="question_attr" id="question_attr_<%= i %>"
                     <% if is_answer_flag %>checked="true"<% end %> />
              <label><%= attrs_array[i] %></label>
              <%= link_to "删除","#"%>
            </div>
          <% end if attrs_array and attrs_array.any? %>
        </div>
        <div class="answer">分值：<%= f.text_field :score ,:class=>"input_style",:value=>"#{edit_problem.attributes["score"]}"%></div>
        <div class="title">解析：<br/>
          <%= f.text_area :rule ,:cols=>"45",:rows=>"3",:class=>"textarea_style" ,:value=>edit_problem.elements["questions"].elements["question"].elements["analysis"].text %>
        </div>
        <div class="tag">标签：
          <% if edit_problem.elements["questions"].elements["question"].elements["tags"].text %>
            <% tags = edit_problem.elements["questions"].elements["question"].elements["tags"].text.split(" ") %>
            <% tags.each do |tag| %>
              <div class="attr">
                <%= tag %><%= link_to "删除", "#" %>
              </div>
            <% end %>
          <% end %>
          <a href="#">追加标签</a>
        </div>
        <%= f.submit "提交" ,:class=>"submit_btn" %>
      <% end %>
    </div>
  </div>
</div>